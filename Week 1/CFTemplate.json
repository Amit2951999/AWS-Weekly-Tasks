{
	"AWSTemplateFormatVersion": "2010-09-09",
	"Description": "A template for event based trigger on S3 using Lmabda",
	"Resources": {

		"copyTrigger": {
			"Type": "AWS::Lambda::Function",
			"Properties": {
				"Code": { 
					"S3Bucket": "copy-trigger-lambda-func-bucket",
					"S3Key": "lambda_function.zip"
				},
				"Description": "This Function is called whenever an object lands on s3, to copy the object to another bucket",
				"Handler": "lambda_function.lambda_handler",
				"Role": "arn:aws:iam::478055296570:role/S3FullAccess",
				"Runtime" : "python3.9"
			}
		},
		
		"AllowS3ToCallLambdaPermission": {
			"Type": "AWS::Lambda::Permission",
			"DependsOn" : "copyTrigger",
			"Properties": {  
				"FunctionName": { "Fn::GetAtt": [ "copyTrigger", "Arn"] },
				"Action": "lambda:InvokeFunction",
				"Principal": "s3.amazonaws.com",
				"SourceArn": "arn:aws:s3:::primary-s3bucket"
			}
	    }
	}
}




